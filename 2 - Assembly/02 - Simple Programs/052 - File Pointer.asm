; MASM Example - File Pointer

; includes
include \masm32\include\masm32rt.inc

.386
.model flat, stdcall
option casemap :none

include \masm32\include\windows.inc
include \masm32\include\kernel32.inc
includelib \masm32\lib\kernel32.lib

.data
    fileName db "testfile.txt", 0
    fileHandle dd ?
    bytesRead dd ?
    buffer db 11 dup(0)

.code
start:
    ; Open the file
    invoke CreateFile, addr fileName, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL
    mov fileHandle, eax

    ; Move the file pointer 5 bytes forward from the beginning of the file
    invoke SetFilePointer, fileHandle, 5, NULL, FILE_BEGIN

    ; Read 10 bytes from the file into buffer
    invoke ReadFile, fileHandle, addr buffer, 10, addr bytesRead, NULL

    ; Print the read string to the console
    invoke WriteConsole, GetStdHandle(STD_OUTPUT_HANDLE), addr buffer, bytesRead, addr bytesRead, NULL

    ; Close the handle
    invoke CloseHandle, fileHandle

    ; Terminate the process
    invoke ExitProcess, 0
end start
