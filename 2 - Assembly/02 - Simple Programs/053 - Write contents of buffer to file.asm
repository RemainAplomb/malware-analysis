; MASM Example - Write contents of a buffer to file
; includes
include \masm32\include\masm32rt.inc

.386
.model flat, stdcall
option casemap :none

include \masm32\include\windows.inc
include \masm32\include\kernel32.inc
includelib \masm32\lib\kernel32.lib

.data
    fileName db "output.txt", 0
    fileHandle dd ?
    bytesWritten dd ?
    buffer db "Hello, world!", 0

.code
start:
    ; Open the file (create it if it doesn't exist)
    invoke CreateFile, addr fileName, GENERIC_WRITE, 0, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL
    mov fileHandle, eax

    ; Write the contents of the buffer to the file
    invoke WriteFile, fileHandle, addr buffer, sizeof buffer - 1, addr bytesWritten, NULL

    ; Close the handle
    invoke CloseHandle, fileHandle

    ; Terminate the process
    invoke ExitProcess, 0
end start
