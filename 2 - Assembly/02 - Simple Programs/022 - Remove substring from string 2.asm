; includes
include \masm32\include\masm32rt.inc

; MASM Substring Extraction Example

.386
.model flat, stdcall
option casemap :none

include \masm32\include\windows.inc
include \masm32\include\masm32.inc
include \masm32\include\kernel32.inc

includelib \masm32\lib\masm32.lib
includelib \masm32\lib\kernel32.lib

.data
    originalString db 'Hello, World!', 0
    startPosition  dd 7    ; The index of the first character of the substring (0-based).
    length         dd 5    ; The length of the substring.
    substring      db 256 dup(0) ; Buffer to hold the substring.

.code
start:
    ; Set up the pointers and counters
    mov ecx, length        ; ecx is the counter for the length of the substring
    lea esi, originalString; esi points to the original string
    lea edi, substring     ; edi points to the buffer for the substring
    add esi, startPosition ; move esi to the start of the substring

    ; Copy characters from the original string to the substring
    rep movsb              ; Move ecx bytes from [esi] to [edi]

    ; Print the substring
    invoke StdOut, addr substring

    ; End the program
    invoke ExitProcess, 0

end start
