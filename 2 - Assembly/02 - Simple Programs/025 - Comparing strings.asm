; includes
include \masm32\include\masm32rt.inc

; MASM String Comparison Example

.386
.model flat, stdcall
option casemap :none

include \masm32\include\windows.inc
include \masm32\include\kernel32.inc
include \masm32\include\masm32.inc

includelib \masm32\lib\kernel32.lib
includelib \masm32\lib\masm32.lib

.data
    string1 db 'Hello, World!', 0  ; First string
    string2 db 'Hello, World!', 0  ; Second string
    matchMessage db 'The strings match.', 0
    noMatchMessage db 'The strings do not match.', 0

.code

; Subroutine for comparing two strings. Expects pointers to two strings in esi and edi.
; Returns ZF set if strings are equal and ZF clear if they're not.
compareStrings proc
    .repeat
        mov al, byte ptr [esi]
        cmp al, byte ptr [edi]
        jne notEqual
        add esi, 1
        add edi, 1
        test al, al
    .until zero?
    xor eax, eax
    ret
    notEqual:
    mov eax, 1
    ret
compareStrings endp

start:
    ; Load the addresses of the strings into esi and edi
    lea esi, string1
    lea edi, string2

    ; Call the compareStrings subroutine
    call compareStrings

    ; If the result is 0, the strings match
    test eax, eax
    jz stringsMatch

    ; If we're here, the strings do not match
    invoke StdOut, addr noMatchMessage
    jmp endProgram

    stringsMatch:
    invoke StdOut, addr matchMessage

    endProgram:
    invoke ExitProcess, 0
end start
